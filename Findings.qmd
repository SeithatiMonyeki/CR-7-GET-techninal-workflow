---
title: "Red List Index of ecosystems assessments"
subtitle: "Summary Findings"

date: last-modified
date-format: DD-MM-YYYY
---

```{r setup}
#| echo: false
#| message: false
#| warning: false


library(nbaR)
library(dplyr)
library(tidyr)
#library(stringi)
library(rlang)
library(gt)
library(ggplot2)
library(RColorBrewer)
library(here)

```

```{r, echo=FALSE}

RLIe_GET_L2 <- readxl::read_xlsx("./data/RLIe_GET_L2.xlsx")
RLIe_GET_L3 <- readxl::read_xlsx("./data/RLIe_GET_L3.xlsx")
RLIe_national <- readxl::read_xlsx("./data/RLIe_national.xlsx")

GET_L2.count <- readxl::read_xlsx("./data/GET_L2.count.xlsx")
GET_L3.count <- readxl::read_xlsx("./data/GET_L3.count.xlsx")

GET_L2.ecosytems_count <- readxl::read_xlsx("./data/GET_L2.ecosytems_count.xlsx")
GET_L3.ecosytems_count <- readxl::read_xlsx("./data/GET_L3.ecosytems_count.xlsx")
```

## Background

South Africa is among the first countries to implement the Red List Index of Ecosystems [(Monyeki & Skowno, 2025)](https://nba.sanbi.org.za/content/terrestrial/ter_ets.html), a standardized indicator that tracks temporal trends in ecosystem condition and threat levels. This index builds on ecosystem threat status assessments conducted using the [IUCN Red List of Ecosystems framework](https://nba.sanbi.org.za/content/terrestrial/ter_ets.html), enabling consistent and repeatable monitoring of ecosystem deterioration over time. Ecosystem threat status—the globally recognized Red List of Ecosystems headline indicator—measures the extent to which ecosystems are losing vital aspects of their structure, function, or composition, or conversely, the degree to which they remain intact.

To date, national trends have been assessed only for terrestrial ecosystems, with plans to expand the assessment scope in the near future to include ecosystems across all realms. In parallel with the RLIe application, South Africa has made substantial progress in crosswalking its national ecosystem classification across realms to the IUCN Global Ecosystem Typology [(Dayaram et al., 2021)](South African
National Ecosystem Classification System Handbook). The IUCN Global Ecosystem Typology is a global, hierarchical classification system designed to consistently describe ecosystems, thereby enabling comparability of ecosystem assessments across regions, realms, and spatial scales [(Keith et al., 2020)](https://portals.iucn.org/library/node/49250).

Many of South Africa’s ecosystems are nested within higher-level functional units of the IUCN GET, specifically Level 2 (functional biomes) and Level 3 (ecosystem functional groups). These levels were used as the primary analytical and reporting units to ensure a consistent application of the RLIe indicator across terrestrial ecosystems. In total, South Africa’s 463 terrestrial ecosystem types were matched to five IUCN GET Level 2 functional biomes, while the crosswalk to GET Level 3 resulted in 11 ecosystem functional groups.

The Red List Index of Ecosystems (RLIe) was calculated at both IUCN Global Ecosystem Typology (GET) Level 2 and Level 3 across four assessment periods (2014, 2018, 2022, and 2024). The index ranges from 0 to 1, where a value of 0 indicates that all ecosystems within a given functional biome or ecosystem functional group have collapsed, and a value of 1 indicates that all ecosystems within the functional biome or ecosystem functional group are classified as Least Concern. Importantly, an RLIe value of 1 does not imply the absence of threats; rather, it indicates that the cumulative impacts of ongoing pressures have not yet reached the thresholds required to trigger threat categories under the IUCN Red List of Ecosystems criteria.

## Global Ecosystem Typology at Level 2

```{r getL2_plot, echo=FALSE, fig.width=9, fig.height=4.5}
#| label: fig-1
#| fig-cap: "Red List Index of Ecosystems (RLIe) assessed at IUCN Global Ecosystem Typology (GET) Level 2 for South Africa. Changes in the slope of each line indicate the rate at which ecosystem functional groups within each GET Level 2 category are becoming more threatened over time. Lower RLIe values indicate movement towards ecosystem collapse (an RLIe value of 0 indicates complete ecosystem collapse). The aggregate line represents the national mean RLIe across all assessed GET Level 2 categories."

# ---- GET_L2 ----
getL2_levels <- unique(RLIe_GET_L2$GET)
getL2_colors <- setNames(brewer.pal(n = length(getL2_levels), name = "Paired"), getL2_levels)

GET_L2.plot <- ggplot() +
  
  geom_line(data = RLIe_GET_L2,
            aes(x = Year, y = RLIE, color = GET),
            size = 0.7) +
  
  geom_point(data = RLIe_GET_L2,
             aes(x = Year, y = RLIE, color = GET),
             size = 3) +
  
  # Aggregate (national)
  geom_line(data = RLIe_national,
            aes(x = Year, linetype = "Aggregate", shape = "Aggregate", y = RLIE),
            color = "black",
            size = 0.7) +
  
  geom_point(data = RLIe_national,
             aes(x = Year, y = RLIE, shape = "Aggregate"),
             color = "black",
             size = 3) +
  
  # Scales
  scale_color_manual(name = "IUCN Global Ecosystem Typology (Level 2)", values = getL2_colors) +
  scale_linetype_manual(name = "", values = c("Aggregate" = "dotted"), guide = guide_legend(order = 2)) +
  scale_shape_manual(name = "", values = c("Aggregate" = 20), guide = guide_legend(order = 2)) +
  scale_x_continuous(breaks = unique(RLIe_GET_L2$Year)) +
  scale_y_continuous(limits = c(0.4, 1), breaks = seq(0.5, 1, 0.1)) +
  
  # Labels
  labs(x = "Year", y = "Red List Index of ecosystems") +
  
  # Theme
  theme_classic() +
  theme(legend.position = "right",
        legend.box = "vertical",
        legend.text = element_text(size = 8.5),
        legend.title = element_text(size = 10, lineheight = 1.3, margin = margin(b = 7)),
        legend.spacing.y = unit(0.4, 'cm'),
        legend.key.size = unit(0.6, "cm"),
        axis.title.x = element_text(size = 10, margin = margin(t = 12)),
        axis.title.y = element_text(size = 10, margin = margin(r = 12)),
        axis.text = element_text(size = 8.5))

print(GET_L2.plot)

ggsave(filename = "GET_L2.plot.png",
       plot = GET_L2.plot,
       path = "./images",
       width = 45,
       height = 30,
       dpi = 300)
```

The IUCN Global Ecosystem Typology (GET) Level 2 functional biomes reveal patterns broadly consistent with national biome-level trends reported in the [(NBA 2025)](https://nba.sanbi.org.za/content/terrestrial/ter_ets.html). Across the five functional biomes assessed, resilience trajectories vary considerably, reflecting differential vulnerability to environmental pressures.

T2: Temperate–boreal forests and woodlands stands apart as the only biome maintaining consistently high resilience, with an RLIe score of 1.0 across all four assessment periods. All four ecosystems within this functional biome remained classified as Least Concern throughout the timeframe, indicating no detectable deterioration. Importantly, this stability does not signify an absence of pressures—rather, it indicates that existing threats have not yet intensified to thresholds sufficient to trigger higher threat categories.

By comparison, T5: Deserts and semi-deserts and T1: Tropical–subtropical forests show modest but measurable RLIe declines. These decreases reflect gradual escalation of ecosystem risk rather than abrupt shifts into higher threat categories, suggesting a pattern of incremental degradation that warrants continued monitoring.

Most concerning is MT2: Supralittoral coastal systems, which exhibits the steepest RLIe decline among all functional biomes assessed. This pronounced trajectory indicates not only comparatively higher baseline vulnerability but also accelerating risk over the assessment period, positioning coastal interface ecosystems as a priority for targeted conservation intervention.


## Global Ecosystem Typology at Level 3


```{r getL3_plot, echo=FALSE, fig.width=10, fig.height=4.5}
#| label: fig-2
#| fig-cap: "Red List Index of Ecosystems (RLIe) assessed at IUCN Global Ecosystem Typology (GET) Level 3 for South Africa. Changes in the slope of each line indicate the rate at which ecosystem functional groups within each GET Level 3 category are becoming more threatened over time. Lower RLIe values indicate movement towards ecosystem collapse (an RLIe value of 0 indicates complete ecosystem collapse). The aggregate line represents the national mean RLIe across all assessed GET Level 3 categories."
#| 
# ---- Color Palette ----
unique_GETs <- unique(RLIe_GET_L3$GET)
get_colors <- setNames(brewer.pal(n = length(unique_GETs), name = "Paired"),unique_GETs)

# ---- GET_L3 ----

GET_L3.plot <- ggplot() +
  
  geom_line(data = RLIe_GET_L3,
            aes(x = Year, y = RLIE, color = GET),
            size = 0.7) +
  
  geom_point(data = RLIe_GET_L3,
             aes(x = Year, y = RLIE, color = GET),
             size = 3) +
  
  # Aggregate (national)
  geom_line(data = RLIe_national,
            aes(x = Year, linetype = "Aggregate", shape = "Aggregate", y = RLIE),
            color = "black",
            size = 0.7) +
  
  geom_point(data = RLIe_national,
             aes(x = Year, y = RLIE, shape = "Aggregate"),
             color = "black",
             size = 3) +
  
  # Scales
  scale_color_manual(name = "IUCN Global Ecosystem Typology (Level 3)", values = get_colors) +
  scale_linetype_manual(name = "", values = c("Aggregate" = "dotted"), guide = guide_legend(order = 2)) +
  scale_shape_manual(name = "", values = c("Aggregate" = 20), guide = guide_legend(order = 2)) +
  scale_x_continuous(breaks = unique(RLIe_GET_L3$Year)) +
  scale_y_continuous(limits = c(0.4, 1), breaks = seq(0.5, 1, 0.1)) +
  
  # Labels
  labs(x = "Year", y = "Red List Index of ecosystems") +
  
  # Theme
  theme_classic() +
  theme(legend.position = "right",
        legend.box = "vertical",
        legend.text = element_text(size = 9),
        legend.title = element_text(size = 10, lineheight = 1.3, margin = margin(b = 7)),
        legend.spacing.y = unit(0.4, 'cm'),
        legend.key.size = unit(0.6, "cm"),
        axis.title.x = element_text(size = 10, margin = margin(t = 12)),
        axis.title.y = element_text(size = 10, margin = margin(r = 12)),
        axis.text = element_text(size = 8.5))

print(GET_L3.plot)

ggsave(filename = "GET_L3.plot.png",
       plot = GET_L3.plot,
       path = "./images",
       width = 45,
       height = 30,
       dpi = 300)
```

At IUCN GET Level 3, ecosystem functional groups exhibit diverse resilience trajectories that reveal both encouraging stability and emerging vulnerabilities across the assessment period. Three of the eleven functional groups (T2.4 Warm temperate laurophyll forests, T3.1 Seasonally dry tropical shrublands, and T5.1 Semi-desert steppes) maintained an RLIe score of 1.0 across all assessment periods, indicating minimal detectable impacts from anthropogenic land-use pressures. This stability suggests either effective protection or lower baseline exposure to degradation drivers.

Declining ecosystems followed distinct temporal patterns and this is demonstrated through MT2.1 Coastal shrublands and grasslands which experienced the most dramatic deterioration, with RLIe dropping sharply to 0.6 between 2014 and 2018 before stabilizing at this reduced level. Conversely, T3.2 Seasonally dry temperate heaths and shrublands had already declined prior to 2014 and maintained this degraded state (RLIe = 0.6) throughout subsequent assessment periodss, suggesting persistent rather than accelerating pressures.

Aggregated trends confirm a broader erosion of ecosystem resilience. The overall RLIe across all functional groups declined from 0.82 in 2014 to 0.79 in 2024, signaling a gradual but consistent increase in ecosystem threat levels nationally.
These contrasting trajectories underscore a critical management imperative: ecosystem resilience cannot be addressed through uniform interventions. Instead, conservation strategies must be tailored to the specific drivers and temporal dynamics shaping risk within each functional group, with particular attention to coastal systems experiencing acute, ongoing deterioration.

## Red List of Ecosystem at the Global Ecosystem Typology by realm

```{r Function, echo=FALSE}
library(dplyr)
library(tidyr)
library(ggplot2)
library(scales)
library(stringr)

plot_rle_bar_wide <- function(data,
                              group_var,
                              levels_vec,
                              y_label = NULL,
                              show_legend = TRUE,
                              caption = NULL,
                              text_size = 8,
                              label_size = 2,
                              wrap_width = 25,
                              bar_width = 0.7) {

  rle_cols <- c(
    "Least Concern",
    "Near Threatened",
    "Vulnerable",
    "Endangered",
    "Critically Endangered"
  )

  df_long <- data %>%
    pivot_longer(
      cols = all_of(rle_cols),
      names_to  = "RLE",
      values_to = "Count"
    ) %>%
    mutate(
      RLE = factor(RLE, levels = rle_cols),
      {{ group_var }} := factor(
        {{ group_var }},
        levels = if (rlang::as_name(rlang::enquo(group_var)) == "Realm") {
          c("Estuarine", "Marine","Wetland", "River","Terrestrial")
        } else {
          levels_vec
        }
      )
    ) %>%
    group_by({{ group_var }}) %>%
    mutate(prop = Count / sum(Count)) %>%
    ungroup()

  p <- ggplot(df_long, aes(y = {{ group_var }}, x = prop, fill = RLE)) +
    geom_bar(stat = "identity", position = "fill", width = bar_width) +
    geom_text(aes(label = ifelse(Count == 0, "", Count)),
              position = position_fill(vjust = 0.5),
              size = label_size) +
    scale_x_continuous(breaks = c(0, 0.5, 1),
                       labels = scales::percent_format(accuracy = 1)) +
    scale_fill_manual(values = c("#B4D79E", "#CCE226", "#FFD966", "#F6B26B", "#CC0000"),
                      name = NULL) +
    scale_y_discrete(labels = function(x) str_wrap(x, wrap_width)) +
    labs(
      x = "Percentage of ecosystem types",
      y = y_label,
      caption = caption
    ) +
    theme_minimal(base_size = text_size) +
    theme(
      panel.grid.major.y = element_blank(),
      panel.grid.minor.y = element_blank(),
      panel.grid.minor.x = element_blank(),
      panel.grid.major.x = element_line(color = "grey80", size = 0.04),
      axis.title.x = element_text(size = 6),
      axis.title.y = element_text(size = 6),
      legend.title = element_blank(),
      legend.key.height = unit(0.35, "cm"),
      legend.key.width  = unit(0.35, "cm")
    )

  if (!show_legend) {
    p <- p + theme(legend.position = "none")
  }

  return(p)
}

```


```{r barplots, echo=FALSE}
#| fig.height: 2
#| out.width: 100%
#| fig-cap: "IUCN GET Level 2 functional biomes occur in each Realm, by RLE 2025 (A), and (B) IUCN GET Level 3 functional groups occur in each realm"
GET_L2.realm <- plot_rle_bar_wide(GET_L2.count,
                                  group_var  = Realm,
                                  levels_vec = unique(GET_L2.ecosytems_count$Realm),
                                  y_label    = "Realm",
                                   bar_width  = 0.5)

GET_L3.realm <- plot_rle_bar_wide(GET_L3.count,
                                  group_var  = Realm,
                                  levels_vec = unique(GET_L3.ecosytems_count$Realm),
                                  y_label    = "Realm",
                                   bar_width  = 0.5)


# ---- Arrange plots side by side with common legend ----
ggpubr::ggarrange(GET_L2.realm, GET_L3.realm, ncol = 2, labels = c("A", "B"),
  font.label = list(size = 6), common.legend = TRUE, legend = "bottom")

```

When summarized at the realm level, more than 70% of IUCN Global Ecosystem Typology (GET) Level 2 and Level 3 functional biomes within river, wetland, and estuarine realms are classified as threatened. At GET Level 2, inland aquatic realms, including estuarine systems, exhibit the highest proportion of threatened functional biomes (75%).
At the functional group level, freshwater realms show the highest concentration of threatened functional groups, with river and wetland functional groups accounting for 75% and 72% of threatened classifications, respectively, followed by estuarine functional groups (71%). These patterns reflect the generally poor ecological condition of riverine, wetland, and estuarine functional biomes, which are subject to multiple compounding pressures. Chief among these are increasing disruption of hydrological regimes and declining water quality, with fishing pressure representing an additional stressor in estuarine systems.

In contrast, a relatively large proportion of marine and terrestrial functional groups are classified as Least Concern. This is partly attributable to comparatively lower overall pressures in some functional biomes, as well as limitations in available data on pressures affecting utilized functional biomes. 
